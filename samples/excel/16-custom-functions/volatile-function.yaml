order: 1
id: excel-custom-functions-volatile
name: Volatile function
description: Rolls a 6 sided die that returns a possible new value every calculation.
host: EXCEL
api_set:
    CustomFunctionsRuntime: 1.1
script:
    content: |
        /** @CustomFunction */
        function ROLL6SIDEDICE(x: number): number {
          let i:number;
          let result:number;
          result = 0;
          for (i = 0;i<x;i++) {
            var roll:number;
            roll = Math.random()*6;
            roll = Math.round(roll);
            result += roll;
          }
          return result;
        }
    language: typescript
libraries: |
    https://appsforoffice.microsoft.com/lib/1/hosted/office.js
    @types/office-js
    core-js@2.4.1/client/core.min.js